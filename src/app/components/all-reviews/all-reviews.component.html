<app-admin-menu></app-admin-menu>
<div class="page-content">
    	<!-- Page main content START -->
		<div class="page-content-wrapper p-xxl-4">
	
			<!-- Title -->
			<div class="row">
				<div class="col-12 mb-4 mb-sm-5">
					<h1 class="h3 mb-0">Reviews</h1>
				</div>
			</div>

			<!-- Review box START -->
			<div class="row g-4 g-xl-5 mb-5">
				<!-- Growth -->
				<div class="col-md-6 col-lg-4">
					<div class="bg-light p-4 rounded text-center">
						<h6 class="fw-normal">Total Reviews</h6>
						<div class="d-flex align-items-center justify-content-center">
							<h2 class="mb-0 me-2">{{reviews?.length}}</h2>
							<div class="badge bg-success bg-opacity-10 text-success">21% <i class="bi bi-graph-up"></i></div>
						</div>
						<p class="mb-0">Growth in reviews this year</p>
					</div>	
				</div>

				<!-- Average rating -->
				<div class="col-md-6 col-lg-4">
					<div class="bg-light p-4 rounded text-center">
						<h6 class="fw-normal">Average Rating</h6>
						<div class="d-flex align-items-center justify-content-center">
							<h2 class="mb-0 me-2">{{totalreviewavg |  number : '1.0-0' }}</h2>
							<ul class="list-inline mb-0">
								<li class="list-inline-item me-0" *ngFor="let g of tab;let i =index">
                                                      
									<label *ngIf="i>=1">
								   <label  *ngIf="i<=totalreviewavg else elseBlock" >
									<i class="fa-solid fa-star text-warning"></i>
								   </label>
									</label>
								   <ng-template #elseBlock>
								   <i class="far fa-star text-warning"></i>
								   </ng-template>
								   
								</li>
							</ul>
						</div>
						<p class="mb-0">Average rating on this year</p>
					</div>	
				</div>

				<!-- Progress bars -->
				<div class="col-lg-4">
					<div class="bg-light p-4 rounded">
						<div class="row gx-3 g-0 align-items-center">
							<!-- Progress bar and Rating -->
							<div class="col-9 col-sm-10">
								<!-- Progress item -->
								
								<div class="progress progress-sm bg-warning bg-opacity-15">
									
									<div class="progress-bar bg-warning" role="progressbar" [style.width]="(pourcent5*100)/reviews?.length+'%'"  [attr.aria-valuenow]="pourcent5" aria-valuemin="0" [attr.aria-valuemax]="reviews?.length">
									</div>
								</div>
							</div>
							
							<!-- Percentage -->
							<div class="col-3 col-sm-2 text-end">
								<!-- <small><i class="fa-solid fa-star text-warning">5</i></small>  -->
								<span class="h6 fw-light mb-0">{{(pourcent5*100)/reviews?.length |  number : '1.0-0'}}%  </span>
							</div>
						  
							<!-- Progress bar and Rating -->
							<div class="col-9 col-sm-10">
								<!-- Progress item -->
								<div class="progress progress-sm bg-warning bg-opacity-15">
									<div class="progress-bar bg-warning" role="progressbar" [style.width]="(pourcent4*100)/reviews?.length+'%'"  [attr.aria-valuenow]="pourcent4" aria-valuemin="0" [attr.aria-valuemax]="reviews?.length">
									</div>
								</div>
							</div>
							<!-- Percentage -->
							<div class="col-3 col-sm-2 text-end">
								<span class="h6 fw-light mb-0">{{(pourcent4*100)/reviews?.length |  number : '1.0-0'}}%</span>
							</div>

							<!-- Progress bar and Rating -->
							<div class="col-9 col-sm-10">
								<!-- Progress item -->
								<div class="progress progress-sm bg-warning bg-opacity-15">
									<div class="progress-bar bg-warning" role="progressbar" [style.width]="(pourcent3*100)/reviews?.length+'%'"  [attr.aria-valuenow]="pourcent3" aria-valuemin="0" [attr.aria-valuemax]="reviews?.length">
									</div>
								</div>
							</div>
							<!-- Percentage -->
							<div class="col-3 col-sm-2 text-end">
								<span class="h6 fw-light mb-0">{{(pourcent3*100)/reviews?.length |  number : '1.0-0'}}%</span>
							</div>

							<!-- Progress bar and Rating -->
							<div class="col-9 col-sm-10">
								<!-- Progress item -->
								<div class="progress progress-sm bg-warning bg-opacity-15">
									<div class="progress-bar bg-warning" role="progressbar" [style.width]="(pourcent2*100)/reviews?.length+'%'"  [attr.aria-valuenow]="pourcent2" aria-valuemin="0" [attr.aria-valuemax]="reviews?.length">
									</div>
								</div>
							</div>
							<!-- Percentage -->
							<div class="col-3 col-sm-2 text-end">
								<span class="h6 fw-light mb-0">{{(pourcent2*100)/reviews?.length |  number : '1.0-0'}}%</span>
							</div>

							<!-- Progress bar and Rating -->
							<div class="col-9 col-sm-10">
								<!-- Progress item -->
								<div class="progress progress-sm bg-warning bg-opacity-15">
									<div class="progress-bar bg-warning" role="progressbar" [style.width]="(pourcent1*100)/reviews?.length+'%'"  [attr.aria-valuenow]="pourcent1" aria-valuemin="0" [attr.aria-valuemax]="reviews?.length">
									</div>
								</div>
							</div>
							<!-- Percentage -->
							<div class="col-3 col-sm-2 text-end">
								<span class="h6 fw-light mb-0"> {{(pourcent1*100)/reviews?.length |  number : '1.0-0'}}%</span>
							</div>
						</div> <!-- Row END -->
					</div>
				</div>
			</div>
			<!-- Review box END -->

			<!-- Tab and select -->
			<div class="row g-4 justify-content-between align-items-center">
				<div class="col-lg-5">
					<!-- Tabs -->
					<ul class="nav nav-pills-shadow nav-responsive" role="tablist">
						<li class="nav-item" role="presentation"> 
							<a class="nav-link mb-0 me-sm-2 active" data-bs-toggle="tab" href="#tab-1" aria-selected="true" role="tab">All Reviews</a> 
						</li>
						<li class="nav-item" role="presentation">
							<a class="nav-link mb-0 me-sm-2" data-bs-toggle="tab" href="#tab-2" aria-selected="false" tabindex="-1" role="tab">Published</a>
						</li>
						<li class="nav-item" role="presentation"> 
							<a class="nav-link mb-0" data-bs-toggle="tab" href="#tab-3" aria-selected="false" tabindex="-1" role="tab">Deleted</a> 
						</li>
					</ul>
				</div>

				<!-- Select -->
				<div class="col-md-6 col-lg-3">
					<form>
						<select class="form-control js-choice" aria-label=".form-select-sm">
							<option value="">Sort by hotels</option>
							<option>Pride moon Village Resort & Spa</option>
							<option>Courtyard by Marriott New York</option>
							<option>Park Plaza Lodge Hotel</option>
							<option>Royal Beach Resort</option>
						</select>
					</form>
				</div>	
			</div>

			<!-- Reviews START -->
			<div class="vstack gap-4 mt-5">
				<!-- Review item -->
                <div *ngFor="let r of reviews ">
				<div class="row g-3 g-lg-4">
					<div class="col-md-4 col-xxl-3">
						<!-- Avatar and info -->
						<div class="d-flex align-items-center">
							<!-- Avatar -->
							<div class="avatar avatar-xl me-2 flex-shrink-0">
								<img class="avatar-img rounded-circle" src="assets/images/user.png" alt="avatar">
							</div>
							<!-- Info -->
							<div class="ms-2">
								<h5 class="mb-1">{{r.user.username}}</h5>
								<p class="mb-0">{{r.dateCreation | dateAsAgo }}</p>
							</div>
						</div>
					</div>

					<div class="col-md-8 col-xxl-9">
						<!-- Rating -->
						<ul class="list-inline mb-2">
							<li class="list-inline-item me-0" *ngFor="let g of tab;let i =index">
                                                      
								<label *ngIf="i>=1">
							   <label  *ngIf="i<=r.rating else elseBlock" >
								<i class="fa-solid fa-star text-warning"></i>
							   </label>
								</label>
							   <ng-template #elseBlock>
							   <i class="far fa-star text-warning"></i>
							   </ng-template>
							   
							</li>
						</ul>
						
						<h6>
						
						<a class="btn btn-link text-decoration-underline p-0 mb-0 mt-1" data-bs-toggle="modal" data-bs-target="#roomDetail" (mouseenter)="gethoteldetails(r.idrev)"><i class="bi bi-eye-fill me-1" ></i><span class="text-body fw-light">Review on</span> </a></h6>
						
						<p>{{r.content}}.</p>

						<!-- Button -->
						<div class="d-flex justify-content-between align-items-center">
							<div>
								
								<a class="btn btn-sm btn-light mb-0" data-bs-toggle="collapse" href="#g{{r.idReview}}" role="button" aria-expanded="false" aria-controls="collapseComment" >
									Reply 
									<i class="fas fa-check-circle text-success" *ngIf="r.replays?.length!=0"></i>
									<i class="far fa-check-circle" *ngIf="r.replays?.length==0"></i>
								</a>
								
							</div>	
							<a href="#" class="text-primary-hover"><i class="bi bi-trash3 me-1"></i>Delete</a>
						</div>
						<!-- collapse textarea -->
						<div class="collapse " id="g{{r.idReview}}">
							<div *ngFor="let rep of r.replays">
								<p class="mb-0 mt-2">
									{{rep.content}}
								</p>
								</div>
							<form [formGroup]="replayFormGroup" (ngSubmit)="addReplay(r.idReview)">
							<div class="d-flex mt-3">
								
								<textarea class="form-control mb-0" formControlName="content" placeholder="Add a comment..." rows="2" spellcheck="false"></textarea>
								<button class="btn btn-sm btn-primary ms-2 px-4 mb-0 flex-shrink-0"><i class="fas fa-paper-plane fs-5"></i>
									<i *ngIf="isLoading$ | async" class="fas fa-spinner fa-spin"></i>
									<span *ngIf="isLoading$ | async"> replay...</span>
									
								</button>
								
							</div>
						</form>
						</div>
					</div>
				</div>

				<hr class="m-0 mb-3 mt-3"> 
            </div>
			

				<!-- Pagination START -->
				<div class="d-sm-flex justify-content-sm-between align-items-sm-center">
					<!-- Content -->
					<p class="mb-sm-0 text-center text-sm-start">Showing 1 to 8 of 20 entries</p>
					<!-- Pagination -->
					<nav class="mb-sm-0 d-flex justify-content-center" aria-label="navigation">
						<ul class="pagination pagination-sm pagination-primary-soft mb-0">
							<li class="page-item disabled">
								<a class="page-link" href="#" tabindex="-1">Prev</a>
							</li>
							<li class="page-item"><a class="page-link" href="#">1</a></li>
							<li class="page-item active"><a class="page-link" href="#">2</a></li>
							<li class="page-item disabled"><a class="page-link" href="#">..</a></li>
							<li class="page-item"><a class="page-link" href="#">15</a></li>
							<li class="page-item">
								<a class="page-link" href="#">Next</a>
							</li>
						</ul>
					</nav>
				</div>
				<!-- Pagination END -->
			</div>	
			<!-- Reviews END -->

		</div>
		<!-- Page main content END -->
</div>

<!-- Room modal START -->
<div class="modal fade" id="roomDetail" tabindex="-1" aria-labelledby="roomDetailLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content p-0">

			<!-- Title -->
			<div class="modal-header p-3">
				<h5 class="modal-title mb-0" id="roomDetailLabel">Room detail</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>

			<!-- Modal body -->
			<div class="modal-body p-0">

				<!-- Card START -->
				<div class="card bg-transparent p-3">
					<!-- Slider START -->
					<div class="tiny-slider arrow-round arrow-dark overflow-hidden rounded-2">
						<div class="tiny-slider-inner rounded-2 overflow-hidden" data-autoplay="true" data-arrow="true" data-dots="false" data-items="1">
							<!-- Image item -->
							<div> <img [src]="hotel?.hotelImages[0]?.url" class="rounded-2" style=" height:267px;" alt="Card image"></div>

						

							
						</div>
					</div>
					<!-- Slider END -->

					<!-- Card header -->
					<div class="card-header bg-transparent pb-0">
						<h3 class="card-title mb-0">{{hotel?.namehotel}}</h3>
					</div>

					<!-- Card body START -->
					<div class="card-body">
						<!-- Content -->
						<p> {{hotel?.activite}} </p>
						
						<div class="row">
							<h5 class="mb-0">Amenities</h5>

							<!-- List -->
							<div class="col-md-6">
								<!-- List -->
								<ul class="list-group list-group-borderless mt-2 mb-0">
									<li class="list-group-item d-flex mb-0">
										<i class="fa-solid fa-check-circle text-success me-2"></i><span class="h6 fw-light mb-0">Swimming pool</span>
									</li>
									<li class="list-group-item d-flex mb-0">
										<i class="fa-solid fa-check-circle text-success me-2"></i><span class="h6 fw-light mb-0">Spa</span>
									</li>
									<li class="list-group-item d-flex mb-0">
										<i class="fa-solid fa-check-circle text-success me-2"></i><span class="h6 fw-light mb-0">Kids play area.</span>
									</li>
									<li class="list-group-item d-flex mb-0">
										<i class="fa-solid fa-check-circle text-success me-2"></i><span class="h6 fw-light mb-0">Gym</span>
									</li>
								</ul>
							</div>

							<!-- List -->
							<div class="col-md-6">
								<!-- List -->
								<ul class="list-group list-group-borderless mt-2 mb-0">
									<li class="list-group-item d-flex mb-0">
										<i class="fa-solid fa-check-circle text-success me-2"></i><span class="h6 fw-light mb-0">TV</span>
									</li>
									<li class="list-group-item d-flex mb-0">
										<i class="fa-solid fa-check-circle text-success me-2"></i><span class="h6 fw-light mb-0">Mirror</span>
									</li>
									<li class="list-group-item d-flex mb-0">
										<i class="fa-solid fa-check-circle text-success me-2"></i><span class="h6 fw-light mb-0">AC</span>
									</li>
									<li class="list-group-item d-flex mb-0">
										<i class="fa-solid fa-check-circle text-success me-2"></i><span class="h6 fw-light mb-0">Slippers</span>
									</li>
								</ul>
							</div>
						</div> <!-- Row END -->
					</div>
					<!-- Card body END -->
				</div>
				<!-- Card END -->
			</div>
		</div>
	</div>
</div>
<!-- Room modal END -->